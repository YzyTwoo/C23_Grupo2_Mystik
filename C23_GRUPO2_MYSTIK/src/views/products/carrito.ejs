<%- include('../partials/heads.ejs') %>

<body>
    <%- include('../partials/headerProduct.ejs') %>

    <% if(items) { %>
        <div>
            <h1>Carrito de Compras</h1>
            <table class="table">
            <thead>
                <tr>
                    <th>Producto</th>
                    <th>Imagen</th>
                    <th>Precio</th>
                    <th>Cantidad</th>
                    <th>Subtotal</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <% items.forEach(item => { %>
                    <tr>
                        <td><%= item.producto.nombre %></td>
                        <td><img src="<%= item.producto.imagen %>" alt="<%= item.producto.nombre %>" style="width: 50px;"></td>
                        <td>$<%= item.producto.precio %></td>
                        <td><%= item.cantidad %></td>
                        <td>$<%= item.cantidad * parseFloat(item.producto.precio) %></td>
                        <td>
                            <form action="/productos/carrito/<%= item.id %>/actualizar?_method=PUT" method="POST" enctype="multipart/form-data">
                                <input type="number" name="cantidad" value="<%= item.cantidad %>" min="1" max="99">
                                <button type="submit">Actualizar</button>
                            </form>
                        </td>
                        <td>
                            <form action="/productos/carrito/<%= item.id %>/eliminar?_method=DELETE" method="POST" enctype="multipart/form-data">
                                <button type="submit">Eliminar</button>
                            </form>
                        </td>
                    </tr>
                <% }); %>
            </tbody>
        </table>
        <p>Total: $<%= toThousand(total) %></p>
        <button onclick="procederAlPago()">Proceder al Pago</button>
    </div>
    <% } else { %>
        <h1>Carrito de Compras</h1>
        <p>no hay ningun producto agregado</p>
        <a href="/"><button>Seguir comprando</button></a>
    <% } %>
    
    <%- include('../partials/footer.ejs') %>
</body>
</html>
